Seed 1
teacher:audio (resnet18); student:image(resnet18)
Finish Loading teacher model
/home/anaconda3/envs/c2kd/lib/python3.11/site-packages/torch/nn/modules/conv.py:459: UserWarning: Applied workaround for CuDNN issue, install nvrtc.so (Triggered internally at ../aten/src/ATen/native/cudnn/Conv_v8.cpp:80.)
  return F.conv2d(input, weight, bias, self.stride,
Epoch | All epochs: 0 | 100
corr 0.178| num: 0.099
Train Loss: 7.854 | temp1 Loss 4.264 | temp2 Loss 3.590 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 0.000 | 0.000 | 0.000
teacher: Train | Val | Test Accuracy 0.000 | 0.000 | 0.000
Best Val | Test Accuracy | 0.000 | 0.000
Best Teacher Val | Test Accuracy | 0.000 | 0.000
 ----------------------------------------------------------------------
Epoch | All epochs: 1 | 100
corr 0.292| num: 0.167
Train Loss: 5.966 | temp1 Loss 2.485 | temp2 Loss 3.480 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 10.990 | 9.227 | 8.458
teacher: Train | Val | Test Accuracy 62.409 | 50.125 | 44.776
Best Val | Test Accuracy | 9.227 | 8.458
Best Teacher Val | Test Accuracy | 50.125 | 44.776
 ----------------------------------------------------------------------
Epoch | All epochs: 2 | 100
corr 0.372| num: 0.070
Train Loss: 7.043 | temp1 Loss 3.396 | temp2 Loss 3.648 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 7.186 | 8.479 | 6.468
teacher: Train | Val | Test Accuracy 26.359 | 27.182 | 24.378
Best Val | Test Accuracy | 9.227 | 8.458
Best Teacher Val | Test Accuracy | 50.125 | 44.776
 ----------------------------------------------------------------------
Epoch | All epochs: 3 | 100
corr 0.343| num: 0.080
Train Loss: 6.260 | temp1 Loss 2.899 | temp2 Loss 3.361 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 8.031 | 8.229 | 7.463
teacher: Train | Val | Test Accuracy 35.447 | 37.157 | 33.831
Best Val | Test Accuracy | 9.227 | 8.458
Best Teacher Val | Test Accuracy | 50.125 | 44.776
 ----------------------------------------------------------------------
Epoch | All epochs: 4 | 100
corr 0.310| num: 0.106
Train Loss: 6.038 | temp1 Loss 2.690 | temp2 Loss 3.348 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 10.205 | 8.479 | 6.965
teacher: Train | Val | Test Accuracy 38.194 | 38.653 | 34.080
Best Val | Test Accuracy | 9.227 | 8.458
Best Teacher Val | Test Accuracy | 50.125 | 44.776
 ----------------------------------------------------------------------
Epoch | All epochs: 5 | 100
corr 0.361| num: 0.118
Train Loss: 5.954 | temp1 Loss 2.646 | temp2 Loss 3.308 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 9.873 | 7.980 | 7.711
teacher: Train | Val | Test Accuracy 39.130 | 36.658 | 33.333
Best Val | Test Accuracy | 9.227 | 8.458
Best Teacher Val | Test Accuracy | 50.125 | 44.776
 ----------------------------------------------------------------------
Epoch | All epochs: 6 | 100
corr 0.342| num: 0.131
Train Loss: 5.813 | temp1 Loss 2.492 | temp2 Loss 3.321 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 13.164 | 11.471 | 11.692
teacher: Train | Val | Test Accuracy 47.524 | 43.641 | 39.055
Best Val | Test Accuracy | 11.471 | 11.692
Best Teacher Val | Test Accuracy | 50.125 | 44.776
 ----------------------------------------------------------------------
Epoch | All epochs: 7 | 100
corr 0.350| num: 0.141
Train Loss: 5.715 | temp1 Loss 2.421 | temp2 Loss 3.294 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 11.957 | 10.973 | 11.443
teacher: Train | Val | Test Accuracy 49.155 | 42.643 | 40.050
Best Val | Test Accuracy | 11.471 | 11.692
Best Teacher Val | Test Accuracy | 50.125 | 44.776
 ----------------------------------------------------------------------
Epoch | All epochs: 8 | 100
corr 0.366| num: 0.153
Train Loss: 5.645 | temp1 Loss 2.362 | temp2 Loss 3.284 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 12.591 | 12.219 | 10.945
teacher: Train | Val | Test Accuracy 47.554 | 44.389 | 41.045
Best Val | Test Accuracy | 12.219 | 10.945
Best Teacher Val | Test Accuracy | 50.125 | 44.776
 ----------------------------------------------------------------------
Epoch | All epochs: 9 | 100
corr 0.371| num: 0.157
Train Loss: 5.578 | temp1 Loss 2.296 | temp2 Loss 3.282 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 15.429 | 10.474 | 11.940
teacher: Train | Val | Test Accuracy 56.582 | 51.122 | 48.259
Best Val | Test Accuracy | 12.219 | 10.945
Best Teacher Val | Test Accuracy | 51.122 | 48.259
 ----------------------------------------------------------------------
Epoch | All epochs: 10 | 100
corr 0.368| num: 0.158
Train Loss: 5.499 | temp1 Loss 2.243 | temp2 Loss 3.256 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 14.915 | 12.219 | 12.438
teacher: Train | Val | Test Accuracy 56.099 | 51.372 | 47.512
Best Val | Test Accuracy | 12.219 | 12.438
Best Teacher Val | Test Accuracy | 51.372 | 47.512
 ----------------------------------------------------------------------
Epoch | All epochs: 11 | 100
corr 0.367| num: 0.168
Train Loss: 5.430 | temp1 Loss 2.181 | temp2 Loss 3.249 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 14.885 | 12.469 | 11.443
teacher: Train | Val | Test Accuracy 55.827 | 46.883 | 48.507
Best Val | Test Accuracy | 12.469 | 11.443
Best Teacher Val | Test Accuracy | 51.372 | 47.512
 ----------------------------------------------------------------------
Epoch | All epochs: 12 | 100
corr 0.371| num: 0.171
Train Loss: 5.397 | temp1 Loss 2.133 | temp2 Loss 3.264 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 15.610 | 11.721 | 11.443
teacher: Train | Val | Test Accuracy 57.367 | 47.132 | 47.015
Best Val | Test Accuracy | 12.469 | 11.443
Best Teacher Val | Test Accuracy | 51.372 | 47.512
 ----------------------------------------------------------------------
Epoch | All epochs: 13 | 100
corr 0.384| num: 0.174
Train Loss: 5.319 | temp1 Loss 2.094 | temp2 Loss 3.225 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 16.576 | 16.708 | 15.423
teacher: Train | Val | Test Accuracy 61.262 | 53.367 | 50.995
Best Val | Test Accuracy | 16.708 | 15.423
Best Teacher Val | Test Accuracy | 53.367 | 50.995
 ----------------------------------------------------------------------
Epoch | All epochs: 14 | 100
corr 0.380| num: 0.178
Train Loss: 5.223 | temp1 Loss 2.036 | temp2 Loss 3.187 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 17.965 | 18.204 | 16.169
teacher: Train | Val | Test Accuracy 66.787 | 53.367 | 50.995
Best Val | Test Accuracy | 18.204 | 16.169
Best Teacher Val | Test Accuracy | 53.367 | 50.995
 ----------------------------------------------------------------------
Epoch | All epochs: 15 | 100
corr 0.370| num: 0.183
Train Loss: 5.160 | temp1 Loss 1.978 | temp2 Loss 3.181 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 18.478 | 16.958 | 14.428
teacher: Train | Val | Test Accuracy 65.429 | 50.623 | 50.000
Best Val | Test Accuracy | 18.204 | 16.169
Best Teacher Val | Test Accuracy | 53.367 | 50.995
 ----------------------------------------------------------------------
Epoch | All epochs: 16 | 100
corr 0.376| num: 0.186
Train Loss: 5.129 | temp1 Loss 1.955 | temp2 Loss 3.174 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 17.391 | 14.963 | 13.433
teacher: Train | Val | Test Accuracy 68.116 | 55.362 | 51.244
Best Val | Test Accuracy | 18.204 | 16.169
Best Teacher Val | Test Accuracy | 55.362 | 51.244
 ----------------------------------------------------------------------
Epoch | All epochs: 17 | 100
corr 0.380| num: 0.186
Train Loss: 5.139 | temp1 Loss 1.969 | temp2 Loss 3.170 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 17.542 | 17.456 | 14.925
teacher: Train | Val | Test Accuracy 70.109 | 55.112 | 51.990
Best Val | Test Accuracy | 18.204 | 16.169
Best Teacher Val | Test Accuracy | 55.362 | 51.244
 ----------------------------------------------------------------------
Epoch | All epochs: 18 | 100
corr 0.387| num: 0.197
Train Loss: 5.014 | temp1 Loss 1.857 | temp2 Loss 3.156 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 19.263 | 19.202 | 14.677
teacher: Train | Val | Test Accuracy 70.501 | 54.863 | 50.498
Best Val | Test Accuracy | 19.202 | 14.677
Best Teacher Val | Test Accuracy | 55.362 | 51.244
 ----------------------------------------------------------------------
Epoch | All epochs: 19 | 100
corr 0.380| num: 0.195
Train Loss: 5.030 | temp1 Loss 1.877 | temp2 Loss 3.153 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 17.572 | 16.209 | 14.428
teacher: Train | Val | Test Accuracy 70.622 | 55.860 | 48.756
Best Val | Test Accuracy | 19.202 | 14.677
Best Teacher Val | Test Accuracy | 55.860 | 48.756
 ----------------------------------------------------------------------
Epoch | All epochs: 20 | 100
corr 0.377| num: 0.192
Train Loss: 5.012 | temp1 Loss 1.849 | temp2 Loss 3.163 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 18.961 | 18.703 | 13.433
teacher: Train | Val | Test Accuracy 72.101 | 52.618 | 54.478
Best Val | Test Accuracy | 19.202 | 14.677
Best Teacher Val | Test Accuracy | 55.860 | 48.756
 ----------------------------------------------------------------------
Epoch | All epochs: 21 | 100
corr 0.382| num: 0.196
Train Loss: 4.882 | temp1 Loss 1.751 | temp2 Loss 3.130 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 19.505 | 17.207 | 18.408
teacher: Train | Val | Test Accuracy 75.181 | 53.865 | 51.990
Best Val | Test Accuracy | 19.202 | 14.677
Best Teacher Val | Test Accuracy | 55.860 | 48.756
 ----------------------------------------------------------------------
Epoch | All epochs: 22 | 100
corr 0.381| num: 0.203
Train Loss: 4.862 | temp1 Loss 1.719 | temp2 Loss 3.143 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 19.565 | 16.708 | 13.682
teacher: Train | Val | Test Accuracy 76.932 | 57.357 | 53.483
Best Val | Test Accuracy | 19.202 | 14.677
Best Teacher Val | Test Accuracy | 57.357 | 53.483
 ----------------------------------------------------------------------
Epoch | All epochs: 23 | 100
corr 0.382| num: 0.203
Train Loss: 4.818 | temp1 Loss 1.699 | temp2 Loss 3.119 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 20.924 | 19.950 | 15.920
teacher: Train | Val | Test Accuracy 78.291 | 56.608 | 54.229
Best Val | Test Accuracy | 19.950 | 15.920
Best Teacher Val | Test Accuracy | 57.357 | 53.483
 ----------------------------------------------------------------------
Epoch | All epochs: 24 | 100
corr 0.379| num: 0.207
Train Loss: 4.810 | temp1 Loss 1.703 | temp2 Loss 3.107 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 20.773 | 17.207 | 16.915
teacher: Train | Val | Test Accuracy 77.748 | 55.112 | 53.731
Best Val | Test Accuracy | 19.950 | 15.920
Best Teacher Val | Test Accuracy | 57.357 | 53.483
 ----------------------------------------------------------------------
Epoch | All epochs: 25 | 100
corr 0.384| num: 0.212
Train Loss: 4.778 | temp1 Loss 1.655 | temp2 Loss 3.123 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 20.652 | 22.444 | 15.423
teacher: Train | Val | Test Accuracy 78.170 | 54.364 | 54.478
Best Val | Test Accuracy | 22.444 | 15.423
Best Teacher Val | Test Accuracy | 57.357 | 53.483
 ----------------------------------------------------------------------
Epoch | All epochs: 26 | 100
corr 0.388| num: 0.205
Train Loss: 4.666 | temp1 Loss 1.592 | temp2 Loss 3.074 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 21.739 | 21.696 | 17.662
teacher: Train | Val | Test Accuracy 81.371 | 58.354 | 55.224
Best Val | Test Accuracy | 22.444 | 15.423
Best Teacher Val | Test Accuracy | 58.354 | 55.224
 ----------------------------------------------------------------------
Epoch | All epochs: 27 | 100
corr 0.385| num: 0.214
Train Loss: 4.642 | temp1 Loss 1.572 | temp2 Loss 3.070 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 21.920 | 20.200 | 13.433
teacher: Train | Val | Test Accuracy 84.964 | 57.606 | 54.229
Best Val | Test Accuracy | 22.444 | 15.423
Best Teacher Val | Test Accuracy | 58.354 | 55.224
 ----------------------------------------------------------------------
Epoch | All epochs: 28 | 100
corr 0.385| num: 0.216
Train Loss: 4.569 | temp1 Loss 1.506 | temp2 Loss 3.063 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 22.192 | 19.950 | 17.164
teacher: Train | Val | Test Accuracy 83.001 | 56.110 | 54.229
Best Val | Test Accuracy | 22.444 | 15.423
Best Teacher Val | Test Accuracy | 58.354 | 55.224
 ----------------------------------------------------------------------
Epoch | All epochs: 29 | 100
corr 0.382| num: 0.213
Train Loss: 4.556 | temp1 Loss 1.489 | temp2 Loss 3.067 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 22.977 | 20.948 | 16.915
teacher: Train | Val | Test Accuracy 84.541 | 56.608 | 53.980
Best Val | Test Accuracy | 22.444 | 15.423
Best Teacher Val | Test Accuracy | 58.354 | 55.224
 ----------------------------------------------------------------------
Epoch | All epochs: 30 | 100
corr 0.381| num: 0.219
Train Loss: 4.491 | temp1 Loss 1.450 | temp2 Loss 3.041 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 21.649 | 17.456 | 15.672
teacher: Train | Val | Test Accuracy 83.394 | 56.608 | 54.478
Best Val | Test Accuracy | 22.444 | 15.423
Best Teacher Val | Test Accuracy | 58.354 | 55.224
 ----------------------------------------------------------------------
Epoch | All epochs: 31 | 100
corr 0.384| num: 0.220
Train Loss: 4.509 | temp1 Loss 1.456 | temp2 Loss 3.052 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 22.585 | 21.197 | 21.144
teacher: Train | Val | Test Accuracy 88.527 | 57.606 | 57.463
Best Val | Test Accuracy | 22.444 | 15.423
Best Teacher Val | Test Accuracy | 58.354 | 55.224
 ----------------------------------------------------------------------
Epoch | All epochs: 32 | 100
corr 0.385| num: 0.217
Train Loss: 4.503 | temp1 Loss 1.447 | temp2 Loss 3.056 | PL_pseu_label Loss 0.000 | PL_output Loss 0.000| cosine Loss 0.000
Train | Val | Test Accuracy 23.641 | 17.456 | 16.169
teacher: Train | Val | Test Accuracy 88.496 | 57.855 | 53.234
Best Val | Test Accuracy | 22.444 | 15.423
Best Teacher Val | Test Accuracy | 58.354 | 55.224
 ----------------------------------------------------------------------
Traceback (most recent call last):
  File "/home/ducca/CMKD/C2KD/ave_new/main_overlap_tag.py", line 91, in <module>
    log_np[run, :] = eval_overlap_tag(loader, device, args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ducca/CMKD/C2KD/ave_new/main_overlap_tag.py", line 45, in eval_overlap_tag
    acc = train_network_distill(stu_type, tea_model, args.num_epochs, loader, net, device, optimizer, args, tea, stu)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ducca/CMKD/C2KD/ave_new/utils/helper.py", line 207, in train_network_distill
    _, train_acc = evaluate(loader['train'], device, net, stu_type)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ducca/CMKD/C2KD/ave_new/utils/helper.py", line 55, in evaluate
    for i, data in enumerate(loader):
  File "/home/anaconda3/envs/c2kd/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/home/anaconda3/envs/c2kd/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1328, in _next_data
    idx, data = self._get_data()
                ^^^^^^^^^^^^^^^^
  File "/home/anaconda3/envs/c2kd/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1284, in _get_data
    success, data = self._try_get_data()
                    ^^^^^^^^^^^^^^^^^^^^
  File "/home/anaconda3/envs/c2kd/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1132, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/anaconda3/envs/c2kd/lib/python3.11/queue.py", line 180, in get
    self.not_empty.wait(remaining)
  File "/home/anaconda3/envs/c2kd/lib/python3.11/threading.py", line 331, in wait
    gotit = waiter.acquire(True, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
